<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='For a chosen ratio of publication probabilities, selection_ratio, estimates
a publication bias-corrected pooled point estimate and confidence interval
per Mathur and VanderWeele (2020)
. Model options include
fixed-effects (a.k.a. "common-effect"), robust independent, and robust
clustered specifications.'><title>Estimate publication bias-corrected meta-analysis — pubbias_meta • PublicationBias</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate publication bias-corrected meta-analysis — pubbias_meta"><meta property="og:description" content='For a chosen ratio of publication probabilities, selection_ratio, estimates
a publication bias-corrected pooled point estimate and confidence interval
per Mathur and VanderWeele (2020)
. Model options include
fixed-effects (a.k.a. "common-effect"), robust independent, and robust
clustered specifications.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PublicationBias</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.4.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mathurlabstanford/PublicationBias/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Estimate publication bias-corrected meta-analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/mathurlabstanford/PublicationBias/blob/HEAD/R/meta.R" class="external-link"><code>R/meta.R</code></a></small>
      <div class="d-none name"><code>pubbias_meta.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>For a chosen ratio of publication probabilities, <code>selection_ratio</code>, estimates
a publication bias-corrected pooled point estimate and confidence interval
per Mathur and VanderWeele (2020)
. Model options include
fixed-effects (a.k.a. "common-effect"), robust independent, and robust
clustered specifications.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pubbias_meta</span><span class="op">(</span></span>
<span>  <span class="va">yi</span>,</span>
<span>  <span class="va">vi</span>,</span>
<span>  <span class="va">sei</span>,</span>
<span>  cluster <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">yi</span><span class="op">)</span>,</span>
<span>  <span class="va">selection_ratio</span>,</span>
<span>  selection_tails <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  model_type <span class="op">=</span> <span class="st">"robust"</span>,</span>
<span>  favor_positive <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  alpha_select <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  ci_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  small <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  return_worst_meta <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">corrected_meta</span><span class="op">(</span></span>
<span>  <span class="va">yi</span>,</span>
<span>  <span class="va">vi</span>,</span>
<span>  <span class="va">eta</span>,</span>
<span>  clustervar <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">yi</span><span class="op">)</span>,</span>
<span>  <span class="va">model</span>,</span>
<span>  selection.tails <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">favor.positive</span>,</span>
<span>  alpha.select <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  CI.level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  small <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>yi</dt>
<dd><p>A vector of point estimates to be meta-analyzed.</p></dd>


<dt>vi</dt>
<dd><p>A vector of estimated variances (i.e., squared standard errors) for
the point estimates.</p></dd>


<dt>sei</dt>
<dd><p>A vector of estimated standard errors for the point estimates.
(Only one of <code>vi</code> or <code>sei</code> needs to be specified).</p></dd>


<dt>cluster</dt>
<dd><p>Vector of the same length as the number of rows in the data,
indicating which cluster each study should be considered part of (defaults
to treating studies as independent; i.e., each study is in its own cluster).</p></dd>


<dt>selection_ratio</dt>
<dd><p>Ratio by which publication bias favors affirmative
studies (i.e., studies with p-values less than <code>alpha_select</code> and
estimates in the direction indicated by <code>favor_positive</code>).</p></dd>


<dt>selection_tails</dt>
<dd><p>1 (for one-tailed selection, recommended for its
conservatism) or 2 (for two-tailed selection).</p></dd>


<dt>model_type</dt>
<dd><p>"fixed" for fixed-effects (a.k.a. "common-effect") or
"robust" for robust random-effects.</p></dd>


<dt>favor_positive</dt>
<dd><p><code>TRUE</code> if publication bias are
assumed to favor significant positive estimates; <code>FALSE</code> if assumed to
favor significant negative estimates.</p></dd>


<dt>alpha_select</dt>
<dd><p>Alpha level at which an estimate's probability of being
favored by publication bias is assumed to change (i.e.,
the threshold at which study investigators, journal editors, etc., consider
an estimate to be significant).</p></dd>


<dt>ci_level</dt>
<dd><p>Confidence interval level (as proportion) for the corrected
point estimate. (The alpha level for inference on the corrected point
estimate will be calculated from <code>ci_level</code>.)</p></dd>


<dt>small</dt>
<dd><p>Should inference allow for a small meta-analysis? We recommend
always using <code>TRUE</code>.</p></dd>


<dt>return_worst_meta</dt>
<dd><p>Should the worst-case meta-analysis of only the
nonaffirmative studies be returned?</p></dd>


<dt>eta</dt>
<dd><p>(deprecated) see selection_ratio</p></dd>


<dt>clustervar</dt>
<dd><p>(deprecated) see cluster</p></dd>


<dt>model</dt>
<dd><p>(deprecated) see model_type</p></dd>


<dt>selection.tails</dt>
<dd><p>(deprecated) see selection_tails</p></dd>


<dt>favor.positive</dt>
<dd><p>(deprecated) see favor_positive</p></dd>


<dt>alpha.select</dt>
<dd><p>(deprecated) see alpha_select</p></dd>


<dt>CI.level</dt>
<dd><p>(deprecated) see ci_level</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code><a href="https://rdrr.io/pkg/metabias/man/metabias-class.html" class="external-link">metabias::metabias()</a></code>, a list containing:</p><dl><dt>data</dt>
<dd><p>A tibble with one row per study and the columns
<code>yi</code>, <code>yif</code>, <code>vi</code>, <code>affirm</code>, <code>cluster</code>.</p></dd>

<dt>values</dt>
<dd><p>A list with the elements <code>selection_ratio</code>, <code>selection_tails</code>, <code>model_type</code>, <code>favor_positive</code>, <code>alpha_select</code>, <code>ci_level</code>, <code>small</code>, <code>k</code>, <code>k_affirmative</code>, <code>k_nonaffirmative</code>.</p></dd>

<dt>stats</dt>
<dd><p>A tibble with the columns <code>model</code>, <code>estimate</code>, <code>se</code>, <code>ci_lower</code>, <code>ci_upper</code>, <code>p_value</code>.</p></dd>

<dt>fit</dt>
<dd><p>A list of fitted models, if any.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>selection_ratio</code> represents the number of times more likely
affirmative studies (i.e., those with a "statistically significant" and
positive estimate) are to be published than nonaffirmative studies (i.e.,
those with a "nonsignificant" or negative estimate).</p>
<p>If <code>favor_positive</code> is <code>FALSE</code>, such that publication bias is assumed to
favor negative rather than positive estimates, the signs of <code>yi</code> will be
reversed prior to performing analyses. The corrected estimate will be
reported based on the recoded signs rather than the original sign
convention.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Mathur MB, VanderWeele TJ (2020).
“Sensitivity analysis for publication bias in meta-analyses.”
<em>Journal of the Royal Statistical Society: Series C (Applied Statistics)</em>, <b>69</b>(5), 1091--1119.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># calculate effect sizes from example dataset in metafor</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://www.metafor-project.org" class="external-link">metafor</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: metafor</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: Matrix</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: metadat</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: numDeriv</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading the 'metafor' package (version 4.2-0). For an</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> introduction to the package please type: help(metafor)</span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">metafor</span><span class="fu">::</span><span class="fu"><a href="https://wviechtb.github.io/metafor/reference/escalc.html" class="external-link">escalc</a></span><span class="op">(</span>measure <span class="op">=</span> <span class="st">"RR"</span>, ai <span class="op">=</span> <span class="va">tpos</span>, bi <span class="op">=</span> <span class="va">tneg</span>, ci <span class="op">=</span> <span class="va">cpos</span>,</span></span>
<span class="r-in"><span>                       di <span class="op">=</span> <span class="va">cneg</span>, data <span class="op">=</span> <span class="va">dat.bcg</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># first fit fixed-effects model without any bias correction</span></span></span>
<span class="r-in"><span><span class="co"># since the point estimate is negative here, we'll assume publication bias</span></span></span>
<span class="r-in"><span><span class="co"># favors negative log-RRs rather than positive ones</span></span></span>
<span class="r-in"><span><span class="fu">metafor</span><span class="fu">::</span><span class="fu"><a href="https://wviechtb.github.io/metafor/reference/rma.uni.html" class="external-link">rma</a></span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data <span class="op">=</span> <span class="va">dat</span>, method <span class="op">=</span> <span class="st">"FE"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fixed-Effects Model (k = 13)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I^2 (total heterogeneity / total variability):   92.12%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> H^2 (total variability / sampling variability):  12.69</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test for Heterogeneity:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q(df = 12) = 152.2330, p-val &lt; .0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> estimate      se      zval    pval    ci.lb    ci.ub      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -0.4303  0.0405  -10.6247  &lt;.0001  -0.5097  -0.3509  *** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># warmup</span></span></span>
<span class="r-in"><span><span class="co"># note that passing selection_ratio = 1 (no publication bias) yields the naive</span></span></span>
<span class="r-in"><span><span class="co"># point estimate from rma above, which makes sense</span></span></span>
<span class="r-in"><span><span class="va">meta</span> <span class="op">&lt;-</span> <span class="fu">pubbias_meta</span><span class="op">(</span>yi <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">yi</span>,</span></span>
<span class="r-in"><span>                     vi <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">vi</span>,</span></span>
<span class="r-in"><span>                     selection_ratio <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                     model_type <span class="op">=</span> <span class="st">"fixed"</span>,</span></span>
<span class="r-in"><span>                     favor_positive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">meta</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   model   estimate     se ci_lower ci_upper     p_value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> pubbias   -<span style="color: #BB0000;">0.430</span> 0.040<span style="text-decoration: underline;">5</span>   -<span style="color: #BB0000;">0.519</span>   -<span style="color: #BB0000;">0.342</span> 0.000<span style="text-decoration: underline;">000</span>185</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># assume a known selection ratio of 5</span></span></span>
<span class="r-in"><span><span class="co"># i.e., affirmative results are 5x more likely to be published than</span></span></span>
<span class="r-in"><span><span class="co"># nonaffirmative ones</span></span></span>
<span class="r-in"><span><span class="va">meta</span> <span class="op">&lt;-</span> <span class="fu">pubbias_meta</span><span class="op">(</span>yi <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">yi</span>,</span></span>
<span class="r-in"><span>                     vi <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">vi</span>,</span></span>
<span class="r-in"><span>                     selection_ratio <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>                     model_type <span class="op">=</span> <span class="st">"fixed"</span>,</span></span>
<span class="r-in"><span>                     favor_positive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">meta</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   model   estimate     se ci_lower ci_upper p_value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> pubbias   -<span style="color: #BB0000;">0.156</span> 0.049<span style="text-decoration: underline;">1</span>   -<span style="color: #BB0000;">0.263</span>  -<span style="color: #BB0000;">0.048</span><span style="color: #BB0000; text-decoration: underline;">5</span> 0.008<span style="text-decoration: underline;">14</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># same selection ratio, but now account for heterogeneity and clustering via</span></span></span>
<span class="r-in"><span><span class="co"># robust specification</span></span></span>
<span class="r-in"><span><span class="va">meta</span> <span class="op">&lt;-</span> <span class="fu">pubbias_meta</span><span class="op">(</span>yi <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">yi</span>,</span></span>
<span class="r-in"><span>                     vi <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">vi</span>,</span></span>
<span class="r-in"><span>                     cluster <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">author</span>,</span></span>
<span class="r-in"><span>                     selection_ratio <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>                     model_type <span class="op">=</span> <span class="st">"robust"</span>,</span></span>
<span class="r-in"><span>                     favor_positive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">meta</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     model   estimate        se   ci_lower   ci_upper    p_value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 pubbias -0.3686171 0.1452243 -0.7849406 0.04770646 0.06905043</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##### Make sensitivity plot as in Mathur &amp; VanderWeele (2020) #####</span></span></span>
<span class="r-in"><span><span class="co"># range of parameters to try (more dense at the very small ones)</span></span></span>
<span class="r-in"><span><span class="va">selection_ratios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">150</span>, <span class="fl">100</span>, <span class="fl">50</span>, <span class="fl">40</span>, <span class="fl">30</span>, <span class="fl">20</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compute estimate for each value of selection_ratio</span></span></span>
<span class="r-in"><span><span class="va">estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">selection_ratios</span>, <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">pubbias_meta</span><span class="op">(</span>yi <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">yi</span>, vi <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">vi</span>, cluster <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">author</span>,</span></span>
<span class="r-in"><span>               selection_ratio <span class="op">=</span> <span class="va">e</span>, model_type <span class="op">=</span> <span class="st">"robust"</span>,</span></span>
<span class="r-in"><span>               favor_positive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">stats</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">estimates</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">estimates</span><span class="op">$</span><span class="va">selection_ratio</span> <span class="op">&lt;-</span> <span class="va">selection_ratios</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: ggplot2</span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">estimates</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">selection_ratio</span>, y <span class="op">=</span> <span class="va">estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">ci_lower</span>, ymax <span class="op">=</span> <span class="va">ci_upper</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>lwd <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="va">eta</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">hat</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span><span class="op">[</span><span class="va">eta</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pubbias_meta-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Mika Braginsky, Maya Mathur, Tyler J. VanderWeele, Peter Solymos.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

